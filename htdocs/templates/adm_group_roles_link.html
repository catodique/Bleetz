<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" ><!-- InstanceBegin template="/Templates/admin2.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Economissimo</title>
<script type="text/javascript"> var page_signature="{$page_signature_runtime}"; </script>
<script type="text/javascript" src="../js/jquery.10.0.min.js"></script>
<link href="../css/app.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" media="screen" href="../css/w2ui.min.css" /> 
<script type="text/javascript" src="../js/w2ui.min.js"></script>

<script>
function openMessagePopup (message) {
	$().w2popup('open', {
		title   : 'String',
		showClose: false,
		body    : message,
		style   : 'padding: 10px',
		width   : 400,
		height  : 200, 
		onBeforeClose:  function () { return false; },
	});
}
$(function () {
var error_message='<bleetz:error mode="s"></bleetz:error>';
if (error_message!="") openMessagePopup(error_message);
});
</script>
<!-- InstanceBeginEditable name="head" -->
<!-- script-->

<!-- InstanceEndEditable -->
</head>
<body >
<div style="text-align:center; ">
  <div style="text-align:left; width:1080px; display:inline-block">
    <div style="width:1080px; height:81px; float:left; background:#FFF" >
      <div class="shell_side"></div>
      <div style="width:1064px; float:left;" >
        <div style="float:left; width:300px; height:73px"></div>
        <div style="float:left;width:764px; height:25px;background-image: url(../imagesPages/shell_fichiers/grismenu_h3-2.gif); ">
          <div class="menu" style="float:right;"> <a  href="admin.myprofile">MON&nbsp;PROFIL</a> <span></span> <a  href="admin.users">UTILISATEURS</a> <span></span> <a  href="admin.groups">GROUPES</a><a class="Menu" href="backoffice.equipiers"></a> <span></span> <a  href="admin.roles">ROLES</a> <span></span><a  href="admin.ressources">Ressources</a> <span></span><a  href="admin.objets">OBJETS</a> <span></span><a href="system.logout" >logout</a></div>
        </div>
        <div style="float:left;width:764px; height:48px;background-image: url(../imagesPages/shell_fichiers/degradevert_h2-3.gif); "><!-- InstanceBeginEditable name="Sous menu" -->
        <bleetz:block name="menu">
          <div class="chemin" ><a  href="backoffice.equipiers">Groupes</a> &gt; <a href="admin.groupShow?grp_id={$grp_id}">{$grp_name}</a> &gt; Distribuer les roles</div>
          <div class="menu" style="float:right;"> <a class="Menu" href="admin.GroupLinkRoles?grp_id={$grp_id}">Distribuer&nbsp;les&nbsp;roles</a><span></span><a class="Menu" href="admin.GroupUpdate?grp_id={$grp_id}">Modifier</a><span></span><a class="Menu" href="admin.GroupDelete?grp_id={$grp_id}">Supprimer</a></div>
        </bleetz:block>
        <!-- InstanceEndEditable --></div>
        <div class="shell_separator"> </div >
      </div>
      <div  class="shell_side"></div>
    </div>
    <div style="width:1080px; height:500px;  float:left; background:#FFF;">
      <div  class="shell_side"></div>
      <div style="float:left; width:1064px;height:500px;text-align:center;overflow:scroll;" >
        <div style="text-align:left;  display:inline-block; min-height:500px;"><!-- InstanceBeginEditable name="contenu" --><bleetz:block name="content">
          <div style="padding:5px;text-align:left">
	<div id="form" style="width: 500px; ">
     <div class="w2ui-page page-0">

      <div class="w2ui-group"  >
      <bleetz:list array="{$roles}">
                          <div class="w2ui-field" style="float: left; width:32%; height:20px; margin :0.5%"> 
                <input type="checkbox" name="rle_link.{$rle_id}" id="checkbox" value="{$rle_id}"/>
                <label for="rle_link.{$rle_id}">{$rle_name}</label>
        </div>
      </bleetz:list>
      </div>
         </div>
         
         <div class="w2ui-buttons">
           <input name="save" type="button" id="save" value="Enregistrer" />
         </div>
	</div>
     
    <script>

	$(function () {
		$('#form').w2form({ 
			name     : 'group-linkroles',
			header   : 'Groupe',
			style1	 : 'border: 1px solid red;',
			url  : '../w2ui.php',
			postData: {
				"page_signature": page_signature,
				"jsframework" 	: "w2ui",
				"component" 	: "form",
				"save-record"	: "system.linkGroupRoles",
			},
			fields: [
	    //<bleetz:list array="{$roles}">
				{ name: 'rle_link.{$rle_id}', type: 'checkbox' },
		//</bleetz:list>
			],
			record: {
				'grp_id' : '{$grp_id}',
    		//<bleetz:list array="{$groles}">
				'rle_link.{$rle_id}' : '1',
			//</bleetz:list>
			},
			actions: {
				reset: function () {
					this.clear();
				},
				save: function () {
					var obj = this;
					this.save({}, function (data) { 
						if (data.status == 'error') {
							console.log('ERROR: '+ data.message);
							return;
						} else if  (data.status == 'success') {
							console.log('SUCCESS: '+ data.message);
							//window.location.href='admin.users';
							return;
						}
						obj.clear();
					});
				},
		}
		});
		
w2ui['group-linkroles'].on('save', function(target, eventData) {
	console.log(eventData);
});

});

    </script>
    </div>
        </bleetz:block><!-- InstanceEndEditable --></div>
      </div>
      <div  class="shell_side"></div>
    </div>
    <div style="width:1080px; height:9px;  float:left; background:#FFF;">
      <div  class="shell_bt_c_l"></div>
      <div class="shell_separator" > </div>
      <div  class="shell_bt_c_r"></div>
    </div>
  </div>
</div>
</body>
<!-- InstanceEnd --></html>